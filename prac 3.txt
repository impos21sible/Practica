-- DROP SCHEMA public;

CREATE SCHEMA public AUTHORIZATION postgres;
-- public.course definition

-- Drop table

-- DROP TABLE public.course;

CREATE TABLE public.course (
	id int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	event_title varchar NOT NULL,
	course_title varchar NULL,
	CONSTRAINT course_pk PRIMARY KEY (id)
);


-- public.country definition

-- Drop table

-- DROP TABLE public.country;

CREATE TABLE public.country (
	id int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	title varchar NOT NULL,
	english_title varchar NOT NULL,
	code varchar(3) NOT NULL,
	code_2 int4 NOT NULL,
	CONSTRAINT country_pk PRIMARY KEY (id)
);


-- public."role" definition

-- Drop table

-- DROP TABLE public."role";

CREATE TABLE public."role" (
	id int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	title varchar NOT NULL,
	CONSTRAINT role_pk PRIMARY KEY (id)
);


-- public.gender definition

-- Drop table

-- DROP TABLE public.gender;

CREATE TABLE public.gender (
	id int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	title varchar NULL,
	CONSTRAINT gender_pk PRIMARY KEY (id)
);


-- public.city definition

-- Drop table

-- DROP TABLE public.city;

CREATE TABLE public.city (
	id int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	title varchar NOT NULL,
	coat_of_arms varchar NULL,
	CONSTRAINT city_pk PRIMARY KEY (id)
);


-- public."user" definition

-- Drop table

-- DROP TABLE public."user";

CREATE TABLE public."user" (
	id int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	id_number int4 NOT NULL,
	surname varchar NOT NULL,
	"name" varchar NOT NULL,
	patronymic varchar NULL,
	email varchar NOT NULL,
	birthday date NOT NULL,
	phone varchar NOT NULL,
	"password" varchar NOT NULL,
	photo varchar NULL,
	country_id int4 NOT NULL,
	gender_id int4 NOT NULL,
	course_id int4 NOT NULL,
	role_id int4 NOT NULL,
	CONSTRAINT user_pk PRIMARY KEY (id),
	CONSTRAINT user_fk FOREIGN KEY (id) REFERENCES public.country(id),
	CONSTRAINT user_fk_1 FOREIGN KEY (id) REFERENCES public.gender(id),
	CONSTRAINT user_fk_2 FOREIGN KEY (id) REFERENCES public.course(id),
	CONSTRAINT user_fk_3 FOREIGN KEY (id) REFERENCES public."role"(id)
);


-- public."event" definition

-- Drop table

-- DROP TABLE public."event";

CREATE TABLE public."event" (
	id int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	title varchar NOT NULL,
	"date" date NOT NULL,
	days int4 NOT NULL,
	city_id int4 NOT NULL,
	course_id int4 NOT NULL,
	winner_id int4 NOT NULL,
	logo varchar NULL,
	CONSTRAINT event_pk PRIMARY KEY (id),
	CONSTRAINT event_fk_1 FOREIGN KEY (id) REFERENCES public.city(id),
	CONSTRAINT event_fk_2 FOREIGN KEY (id) REFERENCES public.course(id),
	CONSTRAINT event_fk_3 FOREIGN KEY (id) REFERENCES public."user"(id)
);


-- public.activity definition

-- Drop table

-- DROP TABLE public.activity;

CREATE TABLE public.activity (
	id int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	title varchar NOT NULL,
	"time" time NOT NULL,
	"day" int4 NOT NULL,
	event_id int4 NOT NULL,
	moderator_id int4 NULL,
	CONSTRAINT activity_pk PRIMARY KEY (id),
	CONSTRAINT activity_fk FOREIGN KEY (id) REFERENCES public."event"(id),
	CONSTRAINT activity_fk_1 FOREIGN KEY (id) REFERENCES public."user"(id)
);


-- public.mark definition

-- Drop table

-- DROP TABLE public.mark;

CREATE TABLE public.mark (
	id int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	jury_id int4 NOT NULL,
	activity_id int4 NOT NULL,
	CONSTRAINT mark_pk PRIMARY KEY (id),
	CONSTRAINT mark_fk FOREIGN KEY (id) REFERENCES public."user"(id),
	CONSTRAINT mark_fk_1 FOREIGN KEY (id) REFERENCES public.activity(id)
);
